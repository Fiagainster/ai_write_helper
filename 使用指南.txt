# AI划词补写小工具 - 使用指南

## 一、软件概述

AI划词补写小工具是一款简洁易用的桌面应用，让您可以在操作系统的任意位置划选文本，通过AI智能分析划词和文档内容，对整个文档进行智能重写和优化。只需划选文本并按下Enter键，AI将自动处理并更新目标文档，无需切换应用程序，实现无缝创作体验。

## 二、系统要求

- 操作系统：Windows 10/11、macOS 10.15+、Linux
- Python版本：3.8或更高版本
- 依赖库：PyQt6、pynput、requests、python-docx等
- 网络连接：需要稳定的互联网连接以调用AI API（Ollama本地模型除外）
- AI服务配置：支持多种AI服务，需根据选择的服务配置相应的API密钥或模型
  - DeepSeek API密钥：用于访问DeepSeek AI生成服务
  - 豆包API密钥：用于访问豆包AI生成服务
  - Kimi API密钥：用于访问Kimi AI生成服务
  - 通义千问API密钥：用于访问通义千问AI生成服务
  - Ollama本地模型：用于本地AI生成服务（无需网络连接）

## 三、安装步骤

### 1. 安装Python环境

如果您的系统尚未安装Python，请先从官网下载并安装Python 3.8或更高版本：https://www.python.org/

### 2. 下载项目代码

将项目代码下载到本地计算机的任意目录。

### 3. 安装依赖

打开命令行工具（Windows：cmd或PowerShell；macOS/Linux：Terminal），导航到项目目录，执行以下命令安装所需依赖：

```
pip install -r requirements.txt
```

## 四、首次使用配置

### 1. 启动应用

在项目目录中执行以下命令启动应用：

```
python main.py
```

启动后，将直接显示主配置窗口。

### 2. 配置AI服务

1. 在主界面的「API设置」区域：
   - 从下拉菜单中选择您要使用的AI服务（DeepSeek、豆包、Kimi、通义千问或Ollama）
   - 根据选择的AI服务，输入相应的API密钥或模型名称并验证：
     - 对于DeepSeek、豆包、Kimi、通义千问：输入API密钥
     - 对于Ollama：输入已下载的模型名称（如llama3、gemma等）
   - 点击「验证」按钮确认配置有效

### 3. 设置目标文档

1. 在「文档设置」区域：
   - 点击「浏览」按钮选择一个已有的文档文件，或直接输入路径
   - 支持的文档格式：.txt、.md、.docx
   - 选择写入模式：
     - 增量写入：生成的内容会追加到文档末尾
     - 全量重写：生成的内容会替换整个文档
     - 光标补写：在文档指定位置插入内容，不改变上下文
   - 动态效果：可选择是否启用最小化球的动态效果

### 4. 配置主题提示词（可选）

1. 在「主题提示词」区域：
   - 输入您希望AI遵循的主题方向指导
   - 例如："科技论文风格"、"商业报告风格"、"创意写作"等

## 五、日常使用方法

### 基本操作流程

#### 增量写入/全量重写模式
1. 在任意应用程序中（如浏览器、Word、记事本等）
2. 用鼠标划选您想要重点关注或修改的文本内容
3. 按下Enter键触发AI处理
4. 观察应用窗口底部的状态栏或最小化球，了解处理进度：
   - 「处理中」：AI正在分析和生成内容
   - 「生成中」：AI正在生成补写内容
   - 「写入中」：AI正在写入文档
   - 「已完成」：处理完成
   - 「已失败」：处理过程中出现问题
5. AI将自动：
   - 读取您选中的文本
   - 读取目标文档的全部内容
   - 结合您设置的主题提示词
   - 对整个文档进行智能重写和优化
6. 重写后的内容将自动更新到目标文档中

#### 光标补写模式
1. **添加光标标记**：在目标文档中，在您希望AI插入内容的位置手动输入`[CURSOR]`（大写，带方括号）
2. **保存文档**：确保标记已保存到文档中
3. 在任意应用程序中用鼠标划选您想要重点关注或修改的文本内容
4. 按下Enter键触发AI处理
5. 观察应用窗口底部的状态栏或最小化球，了解处理进度
6. 处理完成后，查看文档：
   - AI会将生成的内容插入到`[CURSOR]`标记位置
   - 标记会自动移除，不会留在文档中

### 光标补写示例

**步骤1：在文档中添加标记**
```
这是一个测试文档。
我希望AI在这里补写内容：[CURSOR]
这是文档的结尾。
```

**步骤2：使用AI补写后**
```
这是一个测试文档。
我希望AI在这里补写内容：这是AI生成的补写内容。
这是文档的结尾。
```

### 主题提示词使用技巧

主题提示词用于指导AI生成内容的风格和方向：

- **科技论文风格**：输入"科技论文风格，注重数据分析和逻辑推理，使用专业术语"
- **商业报告风格**：输入"商业报告风格，突出结论和行动建议，简洁明了"
- **创意写作风格**：输入"创意写作，使用生动的描述和比喻，富有想象力"
- **教学风格**：输入"教学风格，循序渐进，解释清楚概念和原理"
- **营销文案风格**：输入"营销文案风格，突出产品优势，吸引读者兴趣"

如果不设置主题提示词，AI将保持原文档的专业风格和内容方向。

### 最小化球功能

1. 点击「最小化」按钮将应用最小化为悬浮球
2. 悬浮球会实时显示处理进度，带有动态波纹效果
3. 点击悬浮球可恢复应用窗口
4. 悬浮球始终显示在屏幕最上层，不会被其他窗口遮挡
5. 支持拖拽移动位置

## 六、高级功能

### 完整文档重写

AI不仅仅是补写内容，而是对整个文档进行重写，确保内容的一致性和连贯性。AI会综合分析划词内容和文档上下文，做出全局优化。

### 原子写入保障

系统采用先进的原子写入技术，确保文档更新的安全性：
1. 首先将新内容写入临时文件
2. 验证临时文件写入成功
3. 执行原子替换操作
4. 成功后删除临时文件

这种机制避免了在写入过程中因程序崩溃或系统故障导致的文件损坏问题。

### 内容智能清理

系统会对AI生成的内容进行智能清理，移除不必要的标记和说明文本，确保最终文档的纯净性。

## 七、常见问题解决

### 问题1：应用无法启动

**解决方法**：
- 确保已安装Python 3.8或更高版本
- 检查所有依赖库是否正确安装
- 查看日志文件获取详细错误信息

### 问题2：API密钥或模型验证失败

**解决方法**：
- 检查API密钥或模型名称是否正确输入
- 确保网络连接正常（Ollama除外）
- 确认API密钥是否有效（未过期或被禁用）
- 对于Ollama，确认模型已正确下载

### 问题3：文档未被更新

**解决方法**：
- 检查文档路径是否正确
- 确认您对文档所在目录有写入权限
- 查看日志文件获取详细错误信息

### 问题4：生成内容不符合预期

**解决方法**：
- 调整主题提示词，更精确地描述您期望的风格
- 划选更准确的文本区域，提供更明确的上下文
- 尝试更换不同的AI服务

## 八、故障排除

如果遇到任何问题，请查看应用生成的日志文件，其中包含详细的错误信息和运行状态。

## 九、联系方式

如果您在使用过程中遇到任何问题，或有改进建议，请联系开发者获取支持。

祝您使用愉快！

---

版本：1.0.0
更新日期：2025年